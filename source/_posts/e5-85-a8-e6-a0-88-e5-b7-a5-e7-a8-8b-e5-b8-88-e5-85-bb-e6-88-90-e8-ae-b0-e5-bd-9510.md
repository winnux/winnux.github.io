---
title: 全栈工程师养成记录10
url: 221.html
id: 221
categories:
  - Bob
  - 技术
date: 2017-03-24 10:42:59
tags:
---

关于go的现地侧数据采集程序，上午实验了一下整体架构，做了个测试程序。代码100+行，基本完成了从后端RESTFUL Service API读取数据，然后通过modbus发送到控制设备过程。 这个100+的go程序很简单，主程序启动两个协程，一个处理RestFUL ，一个处理modbus。RestFUL协程 数据读取（GET），解析返回的json对象，如果测试的数据内容改变了，就通过channel把变化数据发给modbus协程；modbus协程正常不断巡检设备数据，同时监听channel，一旦收到下发控制就执行写coil操作。 同时主程序监听系统ctrl+C，收到后，通过channel通知工作协程退出，然后设置一个waitGroup等待协程退出，最后关闭。 用go写这些内容非常简单，比写c代码轻松多了，如果用c的话估计工作量要放大不少，而且还得仔细考虑线程关系等。 在本机测试完毕，现在下一步就能按实际数据把mongodb那里数据schema建立起来，然后把nodejs后端服务完全按实际数据要求做完；接下来就是android app的ui设计及数据刷新机制设计；整体完毕后就是go+nodejs mongodb+android app这一套完整的数据采集-处理-发布显示的完整生态链了。