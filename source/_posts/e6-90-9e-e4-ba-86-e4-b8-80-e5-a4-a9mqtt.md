---
title: 搞了一天mqtt
url: 269.html
id: 269
categories:
  - Bob
  - 技术
date: 2017-05-03 16:52:40
tags:
---

有需求要app控制现地设备调试，昨天想了一下，RESTFUL这个架构不太适合控制命令频繁发送，实际应该也没什么不行的，现地golang程序一直轮询某个api就也可以。但总觉得这么弄不合适~~ 昨天定了mqtt方式，今天来了就开始，golang现地程序，app开发。对了，mqtt broker昨天下班前架构一个，用的开源的mosquitto，以前用过，挺方便。 今天上午最大的障碍说出来都不太信，被android studio里的constrainedlayout搞蒙了，google一下才发现原来要指定各个widget的layoutconstrain，而且能在设计器图形化的操作，实际应该也算比较方便，开始不知道弄了个灰头土脸。 android的mqtt直接用了apache apollo库，ui上一堆控制按钮，每次都连一下然后发一个topic的message。 go的现地开始用了gmq，发现有些问题，重连的问题没调试。它貌似有个断开的handler，没太看源码。 换了eclipse的paho，这个简单测试还可以。   现在实现了app点击按钮发控制命令到服务器的mqtt broker，然后现地golang程序接收topic的message通过modbus协议发出控制命令。 整个环节还比较多，做起来mqtt挺有意思的。 不得不说，现在还是google方式编程，新东西太多，来不及按部就班的学了，用到哪里查到哪里，但还好，一天时间把整个这些程序全部搞定，自我比较安慰。 ！！！