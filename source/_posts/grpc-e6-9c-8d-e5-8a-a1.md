---
title: grpc服务
tags:
  - grpc
url: 504.html
id: 504
categories:
  - Bob
  - 技术
date: 2018-09-05 14:22:42
---

一直想把新技术带到具体工控业务领域，最近测试了grpc+consul做服务分治的模型在工业应用中的实践。 服务发现-服务注册这些基本需求，熔断、限流这些感觉在工业内网的环境中可有可无。加密这些在日渐严格的内网中也是必须的。 consul的服务注册http api实际不使用其对应sdk也能直接访问，两种方式： 1.按照restful api接口直接get 2.按照dns解析域名方式   两种方式各有不同，但最终通过解析返回数据都能拿到对应服务名的所有服务实例ip地址和端口号 wireshark分析实际consul api go的实现中服务发现那里就是直接get了consul服务的api接口的封装。 用QT在c++环境下模拟了一下dns的这个方案，也能正常工作。 目前看还有一个没明白具体使用方式的就是grpc中balance的使用，目前用的withbalancer函数已经被官方标注为deprecated了，推荐使用balancer包里的接口，看了一下这些接口大概是个builder模式的接口，但具体怎么使用没有详细的分析。 目前用这个withbalancer也能正常工作。 下一步有时间要结合docker做一个实际的工业场景服务分治部署实验，可以定义业务有关的服务接口（仅简单实现返回），然后把这个分布式服务环境跑起来，结合带UI的客户端消费者一同测试一下具体应用情况。