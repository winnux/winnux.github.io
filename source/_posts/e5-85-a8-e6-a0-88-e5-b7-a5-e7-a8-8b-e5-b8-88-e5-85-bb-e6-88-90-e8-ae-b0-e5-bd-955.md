---
title: 全栈工程师养成记录5
url: 192.html
id: 192
categories:
  - Bob
  - 技术
date: 2017-03-02 11:03:43
tags:
---

今天一上午连续入坑，这个后端nodejs+mongoose+express 第一个坑，postman发送数组参数，查了一下发现无论怎么写form-data都不行，最后直接raw模式设置为json，手写的json，这样可以了，收到后是数组了。 第二个坑，mongoose默认schema存collection的名会自动变为复数，例如bear 变为bears，这个关键也没啥，db里面show一下也能看到，关键我的一个findone查询没有结果，起初以为是这个原因，设置schema时候加了collection名，还是不行。接下来就是第三个坑 第三个坑，也不能说是坑吧，主要是还不熟悉nodejs这个生态系统，好多东西的思维方式不对，还不是js世界的思路，我想mongoose查询符合uid名符合post过来的参数数组的所有doc，一开始按参数数组写个循环调用findone，这一下犯了两个错误，直接结果就是死活查不到数据。第一个错误，nodejs的工作模型错误，在循环里调用findone，而且还提供了回调func，这基本就搞死了。异步回调函数没法进入了；第二个错误，查找多个匹配应该是js的 in array 方式查询条件，mongoose是支持condition写成{“uid"：{$in: param\_array}}这样的，这直接就把和param\_array匹配的所有结果返回了，在callback func中直接处理就可以了。 这一上午，就一个查询，搞的死去活来，google半天，一直都没找对方向。